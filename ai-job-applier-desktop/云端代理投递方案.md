# äº‘ç«¯ä»£ç†æŠ•é€’æ–¹æ¡ˆ - æŠ€æœ¯å®ç°

## æ¶æ„

```
å­¦ç”Ÿ Web ç•Œé¢ â†’ FastAPI â†’ Redis é˜Ÿåˆ— â†’ Celery Worker â†’ Playwright æŠ•é€’
```

## æ ¸å¿ƒä»£ç 

### 1. ä»»åŠ¡é˜Ÿåˆ—ï¼ˆbackend/tasks.pyï¼‰

```python
from celery import Celery
from playwright.async_api import async_playwright
import asyncio

# Celery é…ç½®
celery_app = Celery(
    'job_applier',
    broker='redis://localhost:6379/0',
    backend='redis://localhost:6379/1'
)

@celery_app.task(bind=True)
def apply_job_task(self, user_id: str, job_data: dict, resume_text: str):
    """
    å¼‚æ­¥æŠ•é€’ä»»åŠ¡
    """
    try:
        # æ›´æ–°ä»»åŠ¡çŠ¶æ€
        self.update_state(state='PROGRESS', meta={'status': 'æ­£åœ¨æŠ•é€’...'})
        
        # è°ƒç”¨ Playwright æŠ•é€’
        result = asyncio.run(do_apply(job_data, resume_text))
        
        # è¿”å›ç»“æœ
        return {
            'success': True,
            'job_title': job_data['title'],
            'company': job_data['company'],
            'result': result
        }
    except Exception as e:
        return {
            'success': False,
            'error': str(e)
        }

async def do_apply(job_data: dict, resume_text: str):
    """
    å®é™…æŠ•é€’é€»è¾‘
    """
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=True)
        page = await browser.new_page()
        
        # åŠ è½½ Cookieï¼ˆä»æ•°æ®åº“è·å–ï¼‰
        # await page.context.add_cookies(cookies)
        
        # è®¿é—®å²—ä½é¡µé¢
        await page.goto(job_data['url'])
        
        # ç‚¹å‡»æŠ•é€’æŒ‰é’®
        await page.click('button:has-text("ç«‹å³æ²Ÿé€š")')
        
        # å‘é€æ‰“æ‹›å‘¼æ¶ˆæ¯
        await page.fill('.chat-input', 'æ‚¨å¥½ï¼Œæˆ‘å¯¹è¿™ä¸ªå²—ä½å¾ˆæ„Ÿå…´è¶£...')
        await page.click('.send-btn')
        
        await browser.close()
        return True
```

### 2. API æ¥å£ï¼ˆbackend/api/apply.pyï¼‰

```python
from fastapi import APIRouter, Depends, HTTPException
from tasks import apply_job_task
from auth import get_current_user

router = APIRouter()

@router.post("/api/submit-apply")
async def submit_apply(
    job_data: dict,
    resume_text: str,
    user = Depends(get_current_user)
):
    """
    æäº¤æŠ•é€’ä»»åŠ¡
    """
    # æ£€æŸ¥ç”¨æˆ·é¢åº¦
    if user.remaining_quota <= 0:
        raise HTTPException(400, "æŠ•é€’æ¬¡æ•°å·²ç”¨å®Œï¼Œè¯·å‡çº§å¥—é¤")
    
    # æäº¤åˆ°é˜Ÿåˆ—
    task = apply_job_task.delay(
        user_id=user.id,
        job_data=job_data,
        resume_text=resume_text
    )
    
    # æ‰£é™¤é¢åº¦
    user.remaining_quota -= 1
    user.save()
    
    return {
        "task_id": task.id,
        "status": "queued",
        "remaining_quota": user.remaining_quota
    }

@router.get("/api/task-status/{task_id}")
async def get_task_status(task_id: str):
    """
    æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
    """
    task = apply_job_task.AsyncResult(task_id)
    
    if task.state == 'PENDING':
        return {"status": "pending", "message": "æ’é˜Ÿä¸­..."}
    elif task.state == 'PROGRESS':
        return {"status": "progress", "message": task.info.get('status')}
    elif task.state == 'SUCCESS':
        return {"status": "success", "result": task.result}
    else:
        return {"status": "failed", "error": str(task.info)}
```

### 3. ç”¨æˆ·è®¤è¯ï¼ˆbackend/auth.pyï¼‰

```python
from fastapi import Depends, HTTPException
from fastapi.security import HTTPBearer
import jwt

security = HTTPBearer()

def get_current_user(token = Depends(security)):
    """
    éªŒè¯ç”¨æˆ· Token
    """
    try:
        payload = jwt.decode(token.credentials, SECRET_KEY, algorithms=["HS256"])
        user_id = payload.get("user_id")
        
        # ä»æ•°æ®åº“è·å–ç”¨æˆ·
        user = db.get_user(user_id)
        if not user:
            raise HTTPException(401, "ç”¨æˆ·ä¸å­˜åœ¨")
        
        return user
    except:
        raise HTTPException(401, "Token æ— æ•ˆ")
```

### 4. å‰ç«¯è°ƒç”¨ï¼ˆStreamlitï¼‰

```python
import streamlit as st
import requests
import time

st.title("ğŸš€ AI æ±‚èŒåŠ©æ‰‹ - è‡ªåŠ¨æŠ•é€’")

# ç”¨æˆ·ç™»å½•
token = st.session_state.get('token')
if not token:
    st.warning("è¯·å…ˆç™»å½•")
    st.stop()

# ä¸Šä¼ ç®€å†
resume_file = st.file_uploader("ä¸Šä¼ ç®€å†", type=['pdf', 'docx'])

# æœç´¢å²—ä½
keyword = st.text_input("æœç´¢å…³é”®è¯", "Python å®ä¹ ")
city = st.text_input("åŸå¸‚", "åŒ—äº¬")

if st.button("æœç´¢å²—ä½"):
    # è°ƒç”¨æœç´¢ API
    response = requests.post(
        "http://your-server.com/api/search-jobs",
        json={"keyword": keyword, "city": city},
        headers={"Authorization": f"Bearer {token}"}
    )
    jobs = response.json()['jobs']
    st.session_state['jobs'] = jobs

# æ˜¾ç¤ºå²—ä½åˆ—è¡¨
if 'jobs' in st.session_state:
    for job in st.session_state['jobs']:
        col1, col2 = st.columns([3, 1])
        with col1:
            st.write(f"**{job['title']}** - {job['company']}")
            st.write(f"ğŸ’° {job['salary']}")
        with col2:
            if st.button("æŠ•é€’", key=job['id']):
                # æäº¤æŠ•é€’ä»»åŠ¡
                response = requests.post(
                    "http://your-server.com/api/submit-apply",
                    json={
                        "job_data": job,
                        "resume_text": resume_text
                    },
                    headers={"Authorization": f"Bearer {token}"}
                )
                
                task_id = response.json()['task_id']
                
                # è½®è¯¢ä»»åŠ¡çŠ¶æ€
                with st.spinner("æŠ•é€’ä¸­..."):
                    while True:
                        status_response = requests.get(
                            f"http://your-server.com/api/task-status/{task_id}"
                        )
                        status = status_response.json()
                        
                        if status['status'] == 'success':
                            st.success("âœ… æŠ•é€’æˆåŠŸï¼")
                            break
                        elif status['status'] == 'failed':
                            st.error(f"âŒ æŠ•é€’å¤±è´¥: {status['error']}")
                            break
                        
                        time.sleep(2)
```

## éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šä½ çš„ç”µè„‘ 24 å°æ—¶å¼€æœº

```bash
# 1. å¯åŠ¨ Redis
redis-server

# 2. å¯åŠ¨ Celery Worker
celery -A tasks worker --loglevel=info

# 3. å¯åŠ¨ FastAPI
uvicorn main:app --host 0.0.0.0 --port 8765

# 4. ä½¿ç”¨å†…ç½‘ç©¿é€ï¼ˆfrp/ngrokï¼‰
# è®©å­¦ç”Ÿå¯ä»¥è®¿é—®ä½ çš„æœ¬åœ°æœåŠ¡
```

**æˆæœ¬**ï¼šÂ¥0ï¼ˆç”¨ä½ çš„ç”µè„‘ï¼‰

### æ–¹æ¡ˆ Bï¼šç§Ÿäº‘æœåŠ¡å™¨

```bash
# é˜¿é‡Œäº‘/è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨
# é…ç½®ï¼š2æ ¸4Gï¼Œ5M å¸¦å®½
# ä»·æ ¼ï¼šÂ¥100-200/æœˆ

# éƒ¨ç½²æ­¥éª¤åŒä¸Š
```

**æˆæœ¬**ï¼šÂ¥100-200/æœˆ

### æ–¹æ¡ˆ Cï¼šServerlessï¼ˆæ¨èï¼‰

```bash
# ä½¿ç”¨ Railway/Render/Fly.io
# è‡ªåŠ¨æ‰©å®¹ï¼ŒæŒ‰éœ€ä»˜è´¹
# ä»·æ ¼ï¼šÂ¥50-100/æœˆï¼ˆå°è§„æ¨¡ï¼‰
```

**æˆæœ¬**ï¼šÂ¥50-100/æœˆ

## å®šä»·ç­–ç•¥

### å…è´¹ç‰ˆ
- æ¯å¤© 5 æ¬¡æŠ•é€’
- ä½“éªŒæ‰€æœ‰åŠŸèƒ½
- å¸å¼•ç”¨æˆ·æ³¨å†Œ

### åŸºç¡€ç‰ˆ - Â¥19.9/æœˆ
- æ¯å¤© 30 æ¬¡æŠ•é€’
- AI ç”Ÿæˆæ±‚èŒä¿¡
- æŠ•é€’è®°å½•ç®¡ç†
- **ç›®æ ‡ç”¨æˆ·**ï¼šæ™®é€šå¤§å­¦ç”Ÿ

### ä¸“ä¸šç‰ˆ - Â¥39.9/æœˆ
- æ¯å¤© 100 æ¬¡æŠ•é€’
- ä¼˜å…ˆæŠ•é€’ï¼ˆè·³è¿‡é˜Ÿåˆ—ï¼‰
- ç®€å†ä¼˜åŒ–å»ºè®®
- æ•°æ®åˆ†ææŠ¥å‘Š
- **ç›®æ ‡ç”¨æˆ·**ï¼šæ€¥éœ€æ‰¾å·¥ä½œçš„å­¦ç”Ÿ

### å¹´è´¹ç‰ˆ - Â¥199/å¹´
- æ— é™æ¬¡æŠ•é€’
- æ‰€æœ‰åŠŸèƒ½
- **ç›®æ ‡ç”¨æˆ·**ï¼šé•¿æœŸæ‰¾å·¥ä½œçš„å­¦ç”Ÿ

## æ”¶å…¥é¢„æµ‹

### ç¬¬ 1 ä¸ªæœˆ
- æ³¨å†Œç”¨æˆ·ï¼š100 äºº
- ä»˜è´¹ç”¨æˆ·ï¼š10 äººï¼ˆ10% è½¬åŒ–ç‡ï¼‰
- å®¢å•ä»·ï¼šÂ¥19.9
- **æ”¶å…¥ï¼šÂ¥199**

### ç¬¬ 3 ä¸ªæœˆ
- æ³¨å†Œç”¨æˆ·ï¼š500 äºº
- ä»˜è´¹ç”¨æˆ·ï¼š75 äººï¼ˆ15% è½¬åŒ–ç‡ï¼‰
- å®¢å•ä»·ï¼šÂ¥25ï¼ˆæ··åˆï¼‰
- **æ”¶å…¥ï¼šÂ¥1,875**

### ç¬¬ 6 ä¸ªæœˆ
- æ³¨å†Œç”¨æˆ·ï¼š2000 äºº
- ä»˜è´¹ç”¨æˆ·ï¼š400 äººï¼ˆ20% è½¬åŒ–ç‡ï¼‰
- å®¢å•ä»·ï¼šÂ¥30ï¼ˆæ··åˆï¼‰
- **æ”¶å…¥ï¼šÂ¥12,000**

## æ¨å¹¿æ¸ é“

### 1. å°çº¢ä¹¦ï¼ˆä¸»æˆ˜åœºï¼‰
- æ ‡é¢˜ï¼š"å¤§å­¦ç”Ÿå¿…å¤‡ï¼è‡ªåŠ¨æŠ•é€’ç®€å†ç¥å™¨"
- å†…å®¹ï¼šä½¿ç”¨æ•™ç¨‹ + æ•ˆæœå±•ç¤º
- ç›®æ ‡ï¼šæ¯å‘¨ 3 ç¯‡ç¬”è®°

### 2. çŸ¥ä¹
- å›ç­”ï¼š"æœ‰å“ªäº›å¤§å­¦ç”Ÿæ‰¾å®ä¹ çš„æŠ€å·§ï¼Ÿ"
- å›ç­”ï¼š"å¦‚ä½•æé«˜ç®€å†æŠ•é€’æ•ˆç‡ï¼Ÿ"
- ç›®æ ‡ï¼šæ¯å‘¨ 5 ä¸ªå›ç­”

### 3. Bç«™
- è§†é¢‘ï¼š"æˆ‘ç”¨è¿™ä¸ªå·¥å…· 3 å¤©æ‹¿åˆ° 5 ä¸ªå®ä¹  offer"
- è§†é¢‘ï¼š"å¤§å­¦ç”Ÿæ‰¾å®ä¹ å¿…å¤‡å·¥å…·æµ‹è¯„"
- ç›®æ ‡ï¼šæ¯å‘¨ 1 ä¸ªè§†é¢‘

### 4. æ ¡å›­ä»£ç†
- æ‹›å‹Ÿæ ¡å›­å¤§ä½¿
- æ¯æ¨è 1 äººä»˜è´¹ï¼Œå¥–åŠ± Â¥5
- ç›®æ ‡ï¼š10 ä¸ªå­¦æ ¡ï¼Œå„ 1 ä¸ªä»£ç†

## æŠ€æœ¯ä¼˜åŠ¿

1. **æ— éœ€å®‰è£…** - æ‰“å¼€ç½‘é¡µå°±èƒ½ç”¨
2. **å®æ—¶åé¦ˆ** - WebSocket æ¨é€è¿›åº¦
3. **æ•°æ®å®‰å…¨** - ç®€å†ä¸å­˜å‚¨ï¼Œç”¨å®Œå³åˆ 
4. **æŒç»­ä¼˜åŒ–** - äº‘ç«¯æ›´æ–°ï¼Œå­¦ç”Ÿæ— æ„ŸçŸ¥
5. **é˜²å°å·** - ä½ æ§åˆ¶æŠ•é€’é¢‘ç‡å’Œç­–ç•¥

## é£é™©æ§åˆ¶

1. **Boss è´¦å·ç®¡ç†**
   - å‡†å¤‡ 5-10 ä¸ª Boss è´¦å·
   - è½®æ¢ä½¿ç”¨ï¼Œé¿å…å•ä¸ªè´¦å·è¢«å°

2. **æŠ•é€’é¢‘ç‡é™åˆ¶**
   - æ¯ä¸ªè´¦å·æ¯å¤©æœ€å¤šæŠ• 50 ä¸ª
   - è‡ªåŠ¨åˆ†é…ä»»åŠ¡åˆ°ä¸åŒè´¦å·

3. **æ³•å¾‹é£é™©**
   - æ·»åŠ å…è´£å£°æ˜
   - ç”¨æˆ·åè®®æ˜ç¡®è´£ä»»

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ä»Šæ™šï¼ˆ2 å°æ—¶ï¼‰
1. âœ… å®‰è£… Redis å’Œ Celery
2. âœ… å®ç°åŸºç¡€ä»»åŠ¡é˜Ÿåˆ—
3. âœ… æµ‹è¯•æŠ•é€’æµç¨‹

### æ˜å¤©ï¼ˆ4 å°æ—¶ï¼‰
1. âœ… æ·»åŠ ç”¨æˆ·è®¤è¯
2. âœ… æ·»åŠ è®¡è´¹ç³»ç»Ÿ
3. âœ… éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨

### åå¤©ï¼ˆ4 å°æ—¶ï¼‰
1. âœ… å†™ç¬¬ä¸€ç¯‡å°çº¢ä¹¦ç¬”è®°
2. âœ… å½•åˆ¶ä½¿ç”¨æ•™ç¨‹è§†é¢‘
3. âœ… æ‰¾ 10 ä¸ªå­¦ç”Ÿå†…æµ‹

### ç¬¬ä¸€å‘¨ç›®æ ‡
- 50 ä¸ªæ³¨å†Œç”¨æˆ·
- 5 ä¸ªä»˜è´¹ç”¨æˆ·
- Â¥100 æ”¶å…¥
```



